# GDAL Configuration for TiTiler Performance Optimization
# Based on: https://developmentseed.org/titiler/advanced/performance_tuning/

# Essential for reducing GET/LIST requests
export GDAL_DISABLE_READDIR_ON_OPEN=EMPTY_DIR

# Cache settings (200MB each)
export GDAL_CACHEMAX=200
export CPL_VSIL_CURL_CACHE_SIZE=200000000

# VSI caching (5MB per file handle)
export VSI_CACHE=TRUE
export VSI_CACHE_SIZE=5000000

# HTTP optimizations
export GDAL_HTTP_MERGE_CONSECUTIVE_RANGES=YES
export GDAL_HTTP_MULTIPLEX=YES
export GDAL_HTTP_VERSION=2

# Block cache optimization
export GDAL_BAND_BLOCK_CACHE=HASHSET

# Limit file extensions for security
export CPL_VSIL_CURL_ALLOWED_EXTENSIONS=".tif,.TIF,.tiff"
